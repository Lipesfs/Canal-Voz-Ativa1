<div id="login">
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="senha" placeholder="Senha">
  <button onclick="login()">Entrar</button>
</div>

<div id="painel" style="display:none;">
  <h2>Mensagens recebidas</h2>
  <ul id="lista"></ul>
</div>

<script type="module">
  import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

  const supabase = createClient('https://sujenbnxjxonknulglrq.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1amVuYm54anhvbmtudWxnbHJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgwOTc4NjgsImV4cCI6MjA2MzY3Mzg2OH0.WUOPmss1E9bZ1zEI9Nxib9cwF5KN8_BBpTjIo4h3YwQ');

  window.login = async () => {
    const email = document.getElementById("email").value;
    const senha = document.getElementById("senha").value;
    const { error } = await supabase.auth.signInWithPassword({ email, password: senha });

    if (!error) carregarMensagens();
    else alert("Login invÃ¡lido");
  };

  async function carregarMensagens() {
    document.getElementById("login").style.display = "none";
    document.getElementById("painel").style.display = "block";

    const { data } = await supabase.from("mensagens").select("*").order("created_at", { ascending: false });

    const lista = document.getElementById("lista");
    lista.innerHTML = "";

    data.forEach(msg => {
      const li = document.createElement("li");
      li.textContent = `${msg.nome} (${msg.email}): ${msg.mensagem}`;
      lista.appendChild(li);
    });
  }
</script>
